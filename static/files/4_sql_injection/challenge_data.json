{
  "app_code": "\nfrom flask import Flask, request, render_template_string\nimport sqlite3\nimport re\n\napp = Flask(__name__)\n\n# Simple WAF (bypassable)\ndef waf_check(input_str):\n    \"\"\"Basic WAF - can be bypassed!\"\"\"\n    blocked = ['SELECT', 'UNION', 'DROP', 'INSERT', '--', '/*', '*/']\n    for keyword in blocked:\n        if keyword.upper() in input_str.upper():\n            return False\n    return True\n\n@app.route('/', methods=['GET', 'POST'])\ndef login():\n    if request.method == 'POST':\n        username = request.form.get('username', '')\n        password = request.form.get('password', '')\n        \n        # WAF check (bypassable with case variations, encoding, etc.)\n        if not waf_check(username) or not waf_check(password):\n            return \"WAF: Suspicious input detected!\"\n        \n        # VULNERABLE SQL QUERY\n        conn = sqlite3.connect('ctf.db')\n        cursor = conn.cursor()\n        query = f\"SELECT * FROM users WHERE username='{username}' AND password='{password}'\"\n        \n        try:\n            result = cursor.execute(query).fetchone()\n            if result:\n                if result[0] == 'admin':\n                    return f\"Welcome admin! Flag: [SOLVE_TO_GET_FLAG]\"\n                return f\"Welcome {result[0]}!\"\n            return \"Invalid credentials\"\n        except Exception as e:\n            return f\"Database error: {str(e)}\"\n    \n    return render_template_string(\"\"\"\n        <html><body>\n            <h1>Secure Login Portal (WAF Protected)</h1>\n            <form method=\"POST\">\n                Username: <input name=\"username\"><br>\n                Password: <input name=\"password\" type=\"password\"><br>\n                <input type=\"submit\" value=\"Login\">\n            </form>\n        </body></html>\n    \"\"\")\n\nif __name__ == '__main__':\n    # Initialize database\n    conn = sqlite3.connect('ctf.db')\n    cursor = conn.cursor()\n    cursor.execute('CREATE TABLE IF NOT EXISTS users (username TEXT, password TEXT)')\n    cursor.execute(\"INSERT INTO users VALUES ('admin', 'impossible_password_12345')\")\n    cursor.execute(\"INSERT INTO users VALUES ('guest', 'guest123')\")\n    conn.commit()\n    \n    app.run(host='0.0.0.0', port=5001, debug=False)\n",
  "url": "http://localhost:5001"
}